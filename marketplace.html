<!doctype html>
<html lang="en">
<head>
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Data Card Marketplace | Allegiance List Marketing</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet"/>
  <style>
    :root{--primary:#0A3D62;--accent:#DC2626;--ink:#1A202C;--muted:#64748b;--light:#F4F7F9;--border:#e5e7eb}
    *{box-sizing:border-box} body{margin:0;font-family:'Roboto',sans-serif;color:var(--ink);background:var(--light)}
    h1,h2{font-family:'Montserrat',sans-serif;color:var(--primary)}
    .header{background:#fff;border-bottom:1px solid rgba(10,61,98,.1)}
    .nav{max-width:1200px;margin:0 auto;height:96px;display:flex;align-items:center;justify-content:space-between;padding:0 20px}
    .brand{display:flex;align-items:center;text-decoration:none}
    .brand img{height:96px;width:auto;display:block}
    .links a{text-decoration:none;color:var(--ink);margin-left:22px;font-weight:600}
    .wrap{max-width:1200px;margin:0 auto;padding:24px 20px 56px}
    .lead{color:#475569;max-width:740px}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:18px;margin-top:20px}
    .card{background:#fff;border:1px solid var(--border);border-radius:16px;padding:16px;display:flex;flex-direction:column;gap:10px}
    .meta{display:flex;gap:10px;flex-wrap:wrap;color:#475569;font-size:.95rem}
    .pill{background:#F1F5F9;border:1px solid #E2E8F0;border-radius:999px;padding:6px 10px}
    .btn{align-self:flex-start;background:var(--primary);color:#fff;font-weight:700;text-decoration:none;border-radius:10px;padding:10px 14px}
    .search{margin-top:16px;display:flex;gap:10px}
    .search input{flex:1;padding:12px 14px;border:1px solid var(--border);border-radius:10px}
  </style>
</head>
<body>
  <header class="header">
    <nav class="nav">
      <a class="brand" href="index.html"><img src="assets/img/alm-logo.png" alt="Allegiance List Marketing logo"></a>
      <div class="links">
        <a href="index.html#services">Services</a>
        <a href="marketplace.html"><b>Marketplace</b></a>
      </div>
    </nav>
  </header>

  <main class="wrap">
    <h1>Data Card Marketplace</h1>
    <p class="lead">Browse our catalog of data cards. Click any item for full details, pricing, selects, and audience profile.</p>

    <div class="search">
      <input id="q" type="search" placeholder="Search by titleâ€¦ (e.g., Real America, Pro-Life, Veterans)">
    </div>

    <section id="cards" class="grid" aria-live="polite"></section>
  </main>

  <script>
    const el=(s,d=document)=>d.querySelector(s);
    const list=el('#cards'); const q=el('#q');
    function fmt(n){return (n||0).toLocaleString()}
    function cardHTML(x){return `
      <article class="card">
        <h2 style="font-size:1.15rem;margin:0">${x.title}</h2>
        <div class="meta">
          <span class="pill">Universe: ${fmt(x.universe)}</span>
          <span class="pill">Base Rate: $${(+x.baseRate||0).toFixed(2)}/M</span>
          <span class="pill">Updated: ${x.lastUpdate||''}</span>
        </div>
        <a class="btn" href="datacard.html?id=${x.id}">View details</a>
      </article>`;}
    let items=[];
    async function load(){ items = await (await fetch('data/datacards.json',{cache:'no-store'})).json(); render(); }
    function render(filter=''){
      const f = filter.trim().toLowerCase();
      list.innerHTML = items
        .filter(x => !f || x.title.toLowerCase().includes(f))
        .sort((a,b)=>a.title.localeCompare(b.title))
        .map(cardHTML).join('');
    }
    q.addEventListener('input', e=>render(e.target.value));
    load();
  </script>
</body>
<section id="dynamic-market" style="padding:24px 16px;max-width:1100px;margin:0 auto">  <h1 style="margin:0 0 12px;font-size:28px">Data Card Marketplace</h1>  <div id="cards-list" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:16px"></div></section><script>(function(){  const url=(window.ALM_DATA_URL||"data/datacards.json")+"?v="+Date.now();  const el=document.getElementById("cards-list");  const norm=x=>({    id: String(x.id ?? x.card_id ?? ""),    title: x.title ?? x.name ?? "",    universe: +(x.universe ?? x.universe_size ?? 0),    baseRate: +(x.baseRate ?? x.base_rate_per_thousand ?? x.base_rate ?? 0),    lastUpdate: x.lastUpdate ?? x.last_updated ?? "",    shortDescription: x.shortDescription ?? x.short_description ?? "",    pdf: x.pdf ?? ""  });  const cardHTML=c=>"<article class=\"card\" style=\"border:1px solid #e5e7eb;border-radius:14px;padding:14px;background:#fff\">    <h2 style=\"font-size:1.05rem;margin:0 0 8px\">"+ (c.title||"Untitled") +"</h2>    <div style=\"font-size:.9rem;color:#475569;margin-bottom:8px\">      <span style=\"display:inline-block;background:#f1f5f9;border:1px solid #e2e8f0;border-radius:999px;padding:3px 8px;margin-right:6px\">Universe: "+(c.universe||0).toLocaleString()+"</span>      <span style=\"display:inline-block;background:#f1f5f9;border:1px solid #e2e8f0;border-radius:999px;padding:3px 8px\">Base Rate: $"+(+c.baseRate||0).toFixed(2)+"/M</span>    </div>"    + (c.shortDescription?"<p style=\"margin:0 0 10px;color:#334155\">"+c.shortDescription+"</p>":"")     + "<div style=\"display:flex;gap:8px;flex-wrap:wrap\">        <a href=\"datacard.html?id="+encodeURIComponent(c.id)+"\"            style=\"text-decoration:none;background:#dc2626;color:#fff;border-radius:999px;padding:8px 12px;font-weight:700\">View details</a>"         + (c.pdf?"<a href=\""+c.pdf+"\" style=\"text-decoration:none;background:#334155;color:#fff;border-radius:999px;padding:8px 12px;font-weight:700\">Download PDF</a>":"") +      "</div>  </article>";  fetch(url,{cache:"no-store"}).then(r=>{if(!r.ok) throw new Error(r.status+" "+r.statusText); return r.json();})    .then(arr=>{ if(!Array.isArray(arr)) throw new Error("JSON root is not an array");      const items=arr.map(norm).filter(c=>c.title);       if(!items.length){ el.innerHTML="<p>No data cards found.</p>"; return; }      items.sort((a,b)=>String(a.title).localeCompare(String(b.title)));      el.innerHTML=items.map(cardHTML).join("");    })    .catch(e=>{ el.innerHTML="<pre style=\"white-space:pre-wrap;color:#b91c1c;background:#fff0f0;border:1px solid #fecaca;padding:10px;border-radius:8px\">Failed to load "+url+"\n"+e+"</pre>"; });})();</script>
</html>
