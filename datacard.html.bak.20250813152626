<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Data Card Details | Allegiance List Marketing</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700;800&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet"/>
  <style>
    :root { --primary:#0A3D62; --accent:#E67E22; --dark:#1A202C; --light:#F4F7F9; --gray:#64748b; --white:#ffffff; --border:#e2e8f0 }
    body { margin:0; font-family:'Roboto',sans-serif; color:var(--dark); background:var(--light) }
    h1,h2,h3,h4 { font-family:'Montserrat',sans-serif; color:var(--primary) }
    .container { max-width:1200px; margin:0 auto; padding:0 2rem }
    .header { background:var(--white); border-bottom:1px solid var(--border) }
    .nav { display:flex; justify-content:space-between; align-items:center; height:96px }
    .brand img{height:96px;width:auto;display:block}
    .nav-links { display:flex; list-style:none; gap:3rem }
    .nav-links a { color:var(--dark); text-decoration:none; font-weight:500 }
    main { padding:40px 0 }
    .breadcrumb { font-size:.9rem; color:var(--gray); margin-bottom:1rem }
    .breadcrumb a { color:var(--primary); text-decoration:none }
    #card-title { font-size:2.4rem; margin-bottom:1rem }
    .datacard-layout { display:grid; grid-template-columns:2fr 1fr; gap:2rem; align-items:flex-start }
    .data-card { background:var(--white); padding:2rem; border-radius:16px; box-shadow:0 4px 12px rgba(0,0,0,0.05); border:1px solid var(--border) }
    .data-card h3 { font-size:1.5rem; margin-top:0; margin-bottom:1.2rem; border-bottom:1px solid var(--border); padding-bottom:1rem }
    .stat-block { display:flex; text-align:center; justify-content:space-around }
    .stat-item .value { font-size:2rem; font-weight:700; color:var(--primary) }
    .stat-item .label { font-size:.9rem; color:var(--gray); text-transform:uppercase }
    .data-table { width:100%; border-collapse:collapse }
    .data-table th, .data-table td { padding:.8rem 1rem; text-align:left; border-bottom:1px solid var(--border) }
    .data-table th { color:var(--gray); font-weight:500 }
    .data-table td.price, .data-table td.count { text-align:right; font-variant-numeric:tabular-nums }
    .key-value-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:1.2rem }
    .kv-item .key { font-weight:700; color:var(--gray); font-size:.9rem; display:block }
    .kv-item .value { font-size:1.05rem }
    .btn { background:var(--primary); color:#fff; border:none; padding:.75rem 1rem; border-radius:8px; font-weight:700; cursor:pointer; text-decoration:none; display:inline-block }
  </style>
</head>
<body>
  <header class="header">
    <nav class="nav container">
      <a href="index.html" class="brand"><img src="assets/img/alm-logo.png" alt="Allegiance List Marketing logo"></a>
      <ul class="nav-links">
        <li><a href="index.html#services">Services</a></li>
        <li><a href="marketplace.html">Data Marketplace</a></li>
      </ul>
    </nav>
  </header>
  <main>
    <div class="container">
      <p class="breadcrumb"><a href="marketplace.html">Data Marketplace</a> / <span id="breadcrumb-title">...</span></p>
      <h1 id="card-title">Loading…</h1>
      <div class="datacard-layout">
        <div class="main-content">
          <div class="data-card" id="key-stats-card">
            <div class="stat-block">
              <div class="stat-item"><div id="card-universe" class="value">-</div><div class="label">Universe</div></div>
              <div class="stat-item"><div id="card-rate" class="value">-</div><div class="label">Base Rate</div></div>
              <div class="stat-item"><div id="card-updated" class="value">-</div><div class="label">Last Updated</div></div>
            </div>
          </div>
          <div class="data-card"><h3>Description</h3><p id="card-description"></p></div>
          <div class="data-card" id="pricing-card"><h3>Pricing</h3>
            <table class="data-table" id="pricing-table"><thead><tr><th>Segment</th><th>Count</th><th style="text-align:right;">Price per Thousand</th></tr></thead><tbody></tbody></table>
          </div>
          <div class="data-card" id="selects-card"><h3>Optional Selects</h3>
            <table class="data-table" id="selects-table"><thead><tr><th>Select</th><th style="text-align:right;">Price per Thousand</th></tr></thead><tbody></tbody></table>
          </div>
          <div class="data-card"><h3>Audience Profile</h3>
            <div class="key-value-grid">
              <div class="kv-item"><span class="key">Source</span><span id="profile-source" class="value"></span></div>
              <div class="kv-item"><span class="key">Geography</span><span id="profile-geo" class="value"></span></div>
              <div class="kv-item"><span class="key">Male</span><span id="profile-male" class="value"></span></div>
              <div class="kv-item"><span class="key">Female</span><span id="profile-female" class="value"></span></div>
            </div>
          </div>
          <div class="data-card" id="pdf-card" style="display:none"><h3>Reference PDF</h3>
            <p><a id="pdf-link" class="btn" target="_blank" rel="noopener">Open PDF</a></p>
          </div>
        </div>
        <aside class="sidebar">
          <div class="data-card">
            <h3>Request Information</h3>
            <p style="font-size:.9rem;color:#64748b;margin-top:-.5rem;margin-bottom:1rem;">For counts, questions, or to place an order.</p>
            <a id="email-btn" class="btn" href="#">Email Us</a>
          </div>
        </aside>
      </div>
    </div>
  </main>
  <script>
    let store=[];
    const qs = new URLSearchParams(location.search);
    const id = qs.get('id');

    (async function(){
      store = await (await fetch('data/datacards.json',{cache:'no-store'})).json();
      const card = store.find(c=>String(c.id)===String(id));
      if(!card){ document.getElementById('card-title').textContent="Data Card Not Found"; return; }

      document.title = card.title + " | Allegiance List Marketing";
      document.getElementById('breadcrumb-title').textContent = card.title;
      document.getElementById('card-title').textContent = card.title;
      document.getElementById('card-universe').textContent = (card.universe||0).toLocaleString();
      document.getElementById('card-rate').textContent = "$" + (+card.baseRate||0).toFixed(2);
      document.getElementById('card-updated').textContent = (card.lastUpdate||"");
      document.getElementById('card-description').textContent = card.description||"";
      document.getElementById('profile-source').textContent = card.source||"";
      document.getElementById('profile-geo').textContent = card.geography||"";
      document.getElementById('profile-male').textContent = card.genderMale||"";
      document.getElementById('profile-female').textContent = card.genderFemale||"";

      const pb = document.querySelector('#pricing-table tbody'); pb.innerHTML="";
      (card.pricing||[]).forEach(row=>{
        pb.innerHTML += `<tr><td>${row.segment||""}</td><td class="count">${(row.count||0).toLocaleString()}</td><td class="price">$${(+row.price||0).toFixed(2)}</td></tr>`;
      });

      const sb = document.querySelector('#selects-table tbody'); sb.innerHTML="";
      (card.selects||[]).forEach(row=>{
        sb.innerHTML += `<tr><td>${row.name||""}</td><td class="price">+$${(+row.price||0).toFixed(2)}</td></tr>`;
      });

      const email = document.getElementById('email-btn');
      const subject = encodeURIComponent("Data Card Inquiry — " + card.title);
      email.href = "mailto:?subject=" + subject;

      if(card.pdf){
        const pdfCard = document.getElementById('pdf-card');
        pdfCard.style.display = "block";
        const link = document.getElementById('pdf-link');
        link.href = card.pdf;
        link.textContent = "Open " + card.title + " PDF";
      }
    })();
  </script>
</body>
</html>
